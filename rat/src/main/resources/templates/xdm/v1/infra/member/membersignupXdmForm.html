<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
<!-- Required meta tags -->
<meta charset="utf-8" />
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no" />

<!-- Meta -->
<meta name="description"
	content="Sapphire - Responsive Bootstrap 5 Dashboard Template" />
<meta name="author" content="Bootstrap Gallery" />
<link rel="canonical" href="https://www.bootstrap.gallery/">
<meta property="og:url" content="https://www.bootstrap.gallery">
<meta property="og:title"
	content="Admin Templates - Dashboard Templates | Bootstrap Gallery">
<meta property="og:description"
	content="Marketplace for Bootstrap Admin Dashboards">
<meta property="og:type" content="Website">
<meta property="og:site_name" content="Bootstrap Gallery">
<link rel="shortcut icon" href="/xdm/v1/images/favicon.svg" />

<!-- Title -->
<title>Sign up</title>

<!-- **** Common Css Files **** -->
<!-- Bootstrap css -->
<link rel="stylesheet" href="/xdm/v1/css/bootstrap.min.css" />

<!-- Bootstrap font icons css -->
<link rel="stylesheet"
	href="/xdm/v1/fonts/bootstrap/bootstrap-icons.css" />

<!-- Main css -->
<link rel="stylesheet" href="/xdm/v1/css/main.min.css" />

<!-- Login css -->
<link rel="stylesheet" href="/xdm/v1/css/login.css" />

<style>
/* 		validaton */
.field-error {
	border-color: #dc3545; /* 빨간색 테두리 */
	color: #dc3545; /* 글자색도 빨간색으로 변경 (선택사항) */
}
</style>

</head>

<!-- Login box start -->
<body class="login-container">
	<div class="container">
		<form id="form" name="form" method="post"
			action="/xdm/v1/infra/member/memberXdmForm">
			<div class="login-box rounded-2 p-5">
				<div class="login-form">
					<a href="index.html" class="login-logo mb-3"> <img
						src="/xdm/v1/images/logo.svg" alt="Crowdnub Admin" />
					</a>
					<h5 class="fw-light mb-5">Sign up</h5>
					<div class="mb-3">
						<label class="form-label">아이디</label> <input type="text"
							id="memberId" name="memberId" th:value="${item?.memberId}"
							class="form-control" placeholder="Enter your Id"
							autocomplete="off" />
					</div>
					<div class="mb-3">
						<label class="form-label">비밀번호</label> <input type="password"
							id="memberPw" name="memberPw" th:value="${item?.memberPw}"
							class="form-control" placeholder="Enter password" />
					</div>
					<div class="mb-3">
						<label class="form-label">비밀번호 확인</label> <input type="password"
							class="form-control" placeholder="Re-enter password" />
					</div>
					<div class="mb-3">
						<label class="form-label">주소</label> <input type="password"
							class="form-control" placeholder="Enter Address" />
					</div>
					<div class="d-flex align-items-center justify-content-between">
						<div class="form-check m-0">
							<input class="form-check-input" type="checkbox" value=""
								id="rememberPassword" /> <label class="form-check-label"
								for="rememberPassword">I agree to the terms and
								conditions</label>
						</div>
					</div>
					<div class="d-grid py-3">
						<button type="button" class="btn btn-lg btn-primary"
							id="btnSubmit">Sign up</button>
					</div>
					<div class="text-center py-3">or Signup with</div>
					<div class="d-flex gap-2 justify-content-center">
						<button type="submit" class="btn btn-outline-light">
							<img src="/xdm/v1/images/google.svg" class="login-icon"
								alt="Login with Google" />
						</button>
						<button type="submit" class="btn btn-outline-light">
							<img src="/xdm/v1/images/facebook.svg" class="login-icon"
								alt="Login with Facebook" />
						</button>
					</div>
					<div class="text-center pt-3">
						<span>Already have an account?</span> <a href="login.html"
							class="text-blue text-decoration-underline ms-2">Login here</a>
					</div>
				</div>
			</div>
		</form>
	</div>
	<!-- Login box end -->
</body>

<!-- * Required JavaScript Files * -->
<!-- Required jQuery first, then Bootstrap Bundle JS -->
<script src="/xdm/v1/js/jquery.min.js"></script>
<script src="/xdm/v1/js/bootstrap.bundle.min.js"></script>
<script src="/xdm/v1/js/modernizr.js"></script>
<script src="/xdm/v1/js/moment.js"></script>
<!-- *** Vendor Js Files *** -->

<!-- Overlay Scroll JS -->
<script
	src="/xdm/v1/vendor/overlay-scroll/jquery.overlayScrollbars.min.js"></script>
<script src="/xdm/v1/vendor/overlay-scroll/custom-scrollbar.js"></script>

<!-- News ticker -->
<script src="/xdm/v1/vendor/newsticker/newsTicker.min.js"></script>
<script src="/xdm/v1/vendor/newsticker/custom-newsTicker.js"></script>

<!-- Main Js Required -->
<script src="/xdm/v1/js/main.js"></script>

<script>
	document.getElementById("btnSubmit").onclick = function() {
		// 		alert(document.getElementById("ifcgName").value);	 

		var memberId = document.getElementById("memberId");
		var memberIdValue = document.getElementById("memberId").value.trim();
		var memberIdRegExp = /^[A-Za-z0-9]{4,12}$/;

		if (memberIdValue == "" || memberIdValue == null) {
			alert("아이디를 입력해 주세요");
			memberId.classList.add("field-error"); // 에러 클래스 추가
			memberId.focus();
			return false;
			// 이 함수를 탈출한다는 의미 true, false 둘다 가능하지만 여기서는 부정적 의미이므로 false 사용
		} else {
			memberId.classList.remove("field-error"); // 에러 클래스 제거
			// 			by pass
		}

		if (!memberIdRegExp.test(memberIdValue)) {
			alert("아이디는 4자 이상 12자 이하의 영대소문자, 숫자만 허용합니다");
			memberId.classList.add("field-error"); // 에러 클래스 추가
			memberId.focus();
			return false;
		} else {
			memberId.classList.remove("field-error"); // 에러 클래스 제거
			// 	    	by pass
		}

		var memberPw = document.getElementById("memberPw");
		var memberPwValue = document.getElementById("memberPw").value.trim();
		var memberPwRegExp = /^(?=.*[a-zA-Z])(?=.*\d)(?=.*[!@#$%^&*()])[a-zA-Z\d!@#$%^&*()]{8,12}$/;

		if (memberPwValue == "" || memberPwValue == null) {
			alert("비밀번호를 입력해주세요");
			memberPw.classList.add("field-error"); // 에러 클래스 추가
			memberPw.focus();
			return false;
		} else {
			memberPw.classList.add("field-error"); // 에러 클래스 추가
			// 			by pass
		}

		if (!memberPwRegExp.test(memberPwValue)) {
			alert("비밀번호는 영문, 숫자, 특수문자의 조합으로 이루어진 8자 이상 12자 이하만 허용합니다");
			memberPw.classList.add("field-error"); // 에러 클래스 추가
			memberPw.focus();
			return false;
		} else {
			memberPw.classList.remove("field-error"); // 에러 클래스 제거
			// 	    	by pass
		}

		// --------------------------------
		$("#mem_pw,#pw_confirm").keyup(function() {
			let mem_pw = $("#mem_pw").val();
			let pw_confirm = $("#pw_confirm").val();

			if (mem_pw == '' && pw_confirm == '') {
				$("#confirmMsg").text("");
				return;
			}

			if (mem_pw.length >= 8 && pw_confirm.length >= 8) {
				if (mem_pw == pw_confirm) {
					$("#confirmMsg").text("비밀번호 일치").css('color', '#000');
					return;
				}
				if (mem_pw != pw_confirm) {
					$("#confirmMsg").text("비밀번호 불일치").css('color', '#fba082');
					return;
				}
			}
		});

		//-------------------------------------------------------------------
		// jQuery 형태로 작성된 AJAX 요청
		$.ajax({
			async : true, // 비동기 요청으로 설정
			cache : false, // 캐시 사용 안 함
			type : "post", // HTTP 요청 방식: POST
			// dataType: "json", // 응답 데이터 형식 (주석 처리됨)

			url : "/xdm/v1/infra/member/membersignupProc", // 요청을 보낼 URL

			// 데이터 전송 형식 설정 (주석 처리된 코드)
			// data: $("#formLogin").serialize(), // 폼 데이터를 직렬화하여 전송
			data : {
				"memberId" : $("#memberId").val(), // 입력된 회원 ID
				"memberPw" : $("#memberPw").val(), // 입력된 비밀번호
				"autoLogin" : $("#autoLogin").is(":checked")
			// 자동 로그인 체크 여부
			},

			// 요청이 성공적으로 완료된 경우 실행되는 콜백 함수
			success : function(response) {
				// 서버로부터 받은 응답의 rt 값이 "success"일 때
				if (response.rt == "success") {
					// 아래 코드는 주석 처리됨
					// if(response.changePwd == "true") {
					//     location.href = "/xdm/v1/infra/member/expiredPwdUsrForm"; // 비밀번호 변경 페이지로 이동
					// } else {
					//     location.href = "/xdm/v1/infra/index/indexXdmView"; // 메인 페이지로 이동
					// }

					// 성공 시 회원 페이지로 이동
					location.href = "/xdm/v1/infra/member/memberXdmForm";
				} else {
					// 실패 시 사용자에게 메시지를 보여주기 위한 주석 처리된 코드
					// document.getElementById("modalAlertTitle").innerText = "확인";
					// document.getElementById("modalAlertBody").innerText = "일치하는 회원이 존재 하지 않습니다!";
					// $("#modalAlert").modal("show"); // 모달 창 표시
				}
			},

			// 요청이 실패했을 때 실행되는 콜백 함수
			error : function(jqXHR, textStatus, errorThrown) {
				// 에러 메시지 알림
				console.error("AJAX 요청 오류:", textStatus, errorThrown); // 오류 정보 출력
				alert("ajaxUpdate " + jqXHR.textStatus + " : "
						+ jqXHR.errorThrown);
			}
		});

		// 폼의 action 속성을 설정 (서버로 요청을 보낼 URL)
		form.action = "/xdm/v1/infra/member/membersignupXdmForm";
		// 폼을 제출하여 서버로 요청
		form.submit();
	}
</script>
</html>